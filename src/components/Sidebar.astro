---
interface Props {
  tags?: string[];
}

const { tags = [] } = Astro.props;
---

<aside class="hidden lg:block w-48 flex-shrink-0">
  <div class="sticky top-15 space-y-4 max-h-[calc(100vh-5rem)] overflow-hidden flex flex-col">
    <!-- Back to Top Button -->
    <button 
      id="backToTop" 
      class="flex items-center gap-2 text-sm font-medium transition-all w-full px-3 py-2 rounded-md hover:shadow-md flex-shrink-0"
      style="background-color: var(--accent-light); color: var(--text-primary);"
    >
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"></path>
      </svg>
      Back to Top
    </button>

    <!-- Tags Section (only show if tags exist) -->
    {tags && tags.length > 0 && (
      <div class="flex-shrink-0">
        <button 
          id="sidebarToggle" 
          class="flex items-center gap-2 text-sm font-semibold mb-3 transition-colors w-full"
          style="color: var(--accent-color);"
        >
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"></path>
          </svg>
          <span id="sidebarToggleText">Tags ({tags.length})</span>
          <svg id="sidebarChevron" class="w-4 h-4 ml-auto transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
          </svg>
        </button>
        <div id="sidebarTags" class="flex flex-col gap-2">
          {tags.map(tag => (
            <a 
              href={`/cyberportfolio/search?q=${encodeURIComponent(tag)}`}
              class="tag-link px-3 py-1.5 text-sm rounded-md transition-all text-center"
              style="background-color: var(--accent-light); color: var(--text-primary);"
            >
              {tag}
            </a>
          ))}
        </div>
      </div>
    )}
    <!-- Table of Contents Toggle (Desktop) -->
    <button
      id="tocToggle"
      class="flex items-center gap-2 text-sm font-semibold mb-3 transition-colors w-full flex-shrink-0"
      style="color: var(--accent-color);"
    >
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
      </svg>
      <span id="tocToggleText">Contents</span>
      <svg id="tocChevron" class="w-4 h-4 ml-auto transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
      </svg>
    </button>
    <div id="sidebarTOC" class="flex flex-col gap-2 overflow-y-auto pr-2 flex-1 min-h-0"></div>
  </div>
</aside>
